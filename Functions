def arr_vision(array):
    out = []
    for i in range(1,len(array)):
        val = torch.tensor(array[i]/array[i-1])
        out.append(float(torch.sigmoid(val)))
    return out

def top_5_vision(arr):
    out = []
    for i in arr:
        hist = arr_vision(i[0])
        act = i[1]
        prof = float(torch.sigmoid(torch.tensor(i[2])))
        for i in hist:
            out.append(i)
        out.append(act)
        out.append(prof)
    return out

def forward_tensor(tp5,hist,mood,optimism):
    tp5 = top_5_vision(tp5)
    hist = arr_vision(hist)
    lst = tp5 + hist
    lst.append(mood)
    lst.append(optimism)
    return torch.tensor(lst)
